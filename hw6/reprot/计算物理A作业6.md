<h1 align = 'center'>计算物理A作业6</h1>

<h3 align = 'center'>吕遨 PB19030789</h3>

## 1.作业题目

对两个函数线型（Gauss分布和类Lorentz型分布），设其一为$p(x)$，另一为$F(x)$，其中常数$a\neq b \neq 1$，用舍选抽样对$p(x)$抽样。将计算得到的归一化频数分布直方图与理论曲线$p(x)$进行比较，讨论差异，讨论抽样效率。
$$
Gaussian:\sim exp(-ax^2) \qquad Lorentzian\ Like: \sim \frac 1 {1+bx^4}
$$


<div align='center'>
    <img src="question6.png" style="zoom:70%;">
</div>



## 2.算法和主要公式

本题中我们采用标准Gauss分布，即取$\large p(x)=\frac{\exp(\frac{-x^2}{2})}{\sqrt{2\pi}}$。Lorentz类分布（比较函数）可取$F(x)=\frac 1 {\sqrt{\pi}(1+\frac {x^4} {16})}$

两个函数的图像如下图所示：

<div align='center'>
    <img src="plot_function.png" style="zoom:50%;">
</div>



理论抽样效率应该为$1/\int_{-\infty}^{+\infin}F(x)\,\text dx=1/\sqrt{2\pi}=0.398942$

$F(x)$的归一化的累积函数为
$$
G(x)=\frac 1 2\left(2 \arctan(1+\frac{x}{\sqrt{2}})-2 \arctan(1-\frac{x}{\sqrt{2}})+\ln\left(\frac{x^2+2\sqrt2x+4}{x^2-2\sqrt2x+4}\right)\right)+\pi
$$
$G(x)$的大致图像如下

<div align='center'>
    <img src="Gx.png" style="zoom:120%;">
</div>



这个函数不易求反函数，因此我们考虑用二分法求出数值解。

考虑到$G(-10)=0.00753731,G(10)=6.27565$，可将初始区间取为$[-10,10]$。

**抽样的具体方法是：**先生成两个$[0,1]$上的随机数序列$\xi_1,\xi_2$。

在$x$方向上，按照$F(x)$的分布抽样。首先要将$\xi_1$乘以一个系数6.28，使其变换为区间$[0,6.28]$上的随机数，之后用二分法解方程
$$
\xi_1 = G(\xi_x)
$$
即可得到$x$方向上抽样点$\xi_x = G^{-1}(\xi_1)$。

在$y$方向上，按照$\frac 1 {F(\xi_x)}$的均匀分布抽样，即
$$
\xi_y = F(\xi_x)\xi_2
$$
最后需要比较大小关系$\xi_y\le p_2(\xi_x)$，是则取，否则舍。



## 3.计算结果及分析

我们分别取总的抽样点数$N=10000,100000,1000000$，分别作出频率分布直方图并计算抽样的效率。图中红色的曲线标准正态分布曲线。

**$N=10000$，效率为0.3936**

<div align='center'>
    <img src="N=10000.png" style="zoom:70%;">
</div>

**$N=100000$，效率为0.399280**

<div align='center'>
    <img src="N=100000.png" style="zoom:70%;">
</div>

**$N=1000000$，效率为0.399121**

<div align='center'>
    <img src="N=1000000.png" style="zoom:70%;">
</div>

可见随着$N$增大，频数分布逐渐趋于理想分布。而抽样效率也比较接近理论值0.398942.



## 4.总结

（1）我们采用舍选抽样得到的归一化的频率分布直方图与理论分布$p(x)$吻合的很好。当$N$增大时，二者越来越接近。

（2）实际的抽样效率与理论值非常接近。

（3）舍选抽样的效率取决于比较函数$F(x)$的选取。本题选取中类Lorentz函数$F(x)$作为比较函数，为了使反函数便于计算，故意将        $F(x)$取得比较”大“，这样相当于浪费了更多面积，减低了抽样效率。应该有另外的参数取法可以使$F(x)$更贴近$p(x)$，这样的话抽样效率会变高。

（4）当比较函数的反函数很难求时，可以考虑用二分法进行数值求解，但这样带来的问题是程序的效率会比较低。

